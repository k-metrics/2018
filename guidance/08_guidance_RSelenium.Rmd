---
title: "第８回データ分析勉強会"
subtitle: "Install Selenium on Windows"
author: "鈴木さんぽう"
date: "`r format(Sys.Date(), format = '%Y年%m月%d日')`"
# date: "2018.01.12"
output:
  ioslides_presentation:
    css: style.css
    df_print: paged
    smaller: false
    widescreen: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)

require(RSelenium)
require(rvest)
require(wdman)
require(tidyverse)

# [RStudio で日本語が使えなくなっていた](https://blog.goo.ne.jp/r-de-r/e/084639aec24beb8a6d08b8241545ef1a)
# Sys.setlocale("LC_ALL", "ja_JP.UTF-8")
```

## Seleniumのインストール

* `RSelenium`はSelenium Serverを操作するためSelenium Serverが必要です
* `wdman`パッケージを使うとSelenium Serverの [インストールと設定 <i class="fa fa-external-link"></i>](https://cran.r-project.org/web/packages/wdman/vignettes/basics.html){target="_blank" title="wdman: Basics"} ができます
    * `wdman`パッケージは`RSelenium`パッケージをインストールすると一緒にインストールされます

```{r eval=FALSE}
wdman::selenium(retcommand = TRUE, verbose = TRUE, check = FALSE)
```

* ただし、Selenium Serverのインストールと設定には**Java（JDK or JRE）が必要**です
* 以降、Windows環境でのJavaのインストール方法を説明します


## Javaのインストール
最近のWindows環境ではJavaが**インストールされていない**ことが多いため、別途、Javaをインストールする必要があります。ただし、2019年1月からOracle Javaは**ビジネス用途では有償（JREも有償）**になりました。業務用PCへのインストールは注意が必要です。  

そこで、無償で使える**Oracle's OpenJDK**をインストールしますが、Oracle Java（JDK, JRE）に比べると脆弱性対応のリリースが長めである点に注意してください。また、64bit版のみでインストーラはありません。  

* [Oracle's OpenJDK <i class="fa fa-external-link"></i>](https://jdk.java.net/11/){target="_blank" title="Java SE 11.0.1 Platform under the GNU General Public License, version 2, with the Classpath Exception."}


## Oracle's OpenJDKのインストール
* [Oracle's OpenJDK(JDK11) <i class="fa fa-external-link"></i>](https://jdk.java.net/11/){target="_blank" title="Java SE 11.0.1 Platform under the GNU General Public License, version 2, with the Classpath Exception."}からWinodws用のzipファイルをダウンロードします
* ダウンロードしたzipファイルを開き中身を任意のフォルダにコピーします
    * 「jdk-11.0.1」フォルダを丸ごとコピーしてください（フォルダ名は2019/1/7時点）
* 「(your folder)\\jdk-11.0.1\\bin」をPATHに追加します
    * Windows10の場合[コントロールパネル]-[システム]-[システムの詳細設定]-[環境変数]から設定できます
* RStudioを起動して`wdman`パッケージを用いてSelenium Serverをインストールします
    * デフォルトでインストールするとサーバのポートは4567になります（Selenium Serverのデフォルトポートは4444）

```{r, eval=FALSE}
wdman::selenium(retcommand = TRUE)
```



# Enjoy!